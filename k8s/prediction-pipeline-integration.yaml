apiVersion: v1
kind: ConfigMap
metadata:
  name: victory36-prediction-pipeline-config
  namespace: victory36
  labels:
    app: victory36-cybersecurity-simulation
    component: prediction-pipeline
    version: v1.0.0
    security-classification: diamond-sao
data:
  # Dr Lucy Flight Memory System (Time Pressors)
  dr-lucy-endpoint: "https://dr-lucy-predictions-859242575175.us-west1.run.app"
  dr-lucy-health-path: "/health"
  dr-lucy-predict-path: "/predict"
  dr-lucy-memory-path: "/memory"
  dr-lucy-status-path: "/status"
  
  # Dream Commander Strategic System (Time Liners)
  dream-commander-endpoint: "https://dream-commander-predictions-859242575175.us-west1.run.app"
  dream-commander-health-path: "/health"
  dream-commander-vision-path: "/vision"
  dream-commander-predict-path: "/predict"
  dream-commander-status-path: "/status"
  
  # Pipeline Configuration
  prediction-timeout: "30s"
  max-concurrent-predictions: "10"
  retry-attempts: "3"
  cache-ttl: "300s"
  
  # Anti-Gravity Power Craft Integration
  time-presser-acceleration-factor: "10.0"
  time-liner-strategic-horizon: "90"
  temporal-coherence-threshold: "0.85"
  prediction-fusion-enabled: "true"
  
  # Claude 4 Pipeline Integration (Direct Anthropic API)
  claude4-pipeline-enabled: "true"
  claude4-model-version: "claude-4-sonnet-20240229"
  claude4-fallback-model: "claude-4-opus-20240229"
  claude4-max-tokens: "8192"
  claude4-temperature: "0.7"
  claude4-api-endpoint: "https://api.anthropic.com/v1/messages"
  claude4-streaming-enabled: "true"
  
  # Deprecate Vertex AI Dependencies
  vertex-ai-deprecated: "true"
  anthropic-direct-api: "true"

---
apiVersion: v1
kind: Secret
metadata:
  name: victory36-prediction-pipeline-credentials
  namespace: victory36
  labels:
    app: victory36-cybersecurity-simulation
    component: prediction-pipeline
    security-classification: diamond-sao
type: Opaque
data:
  # Base64 encoded credentials (activated via temporal compression)
  claude4-api-key: "YW50aHJvcGljX2FwaV9rZXlfcGxhY2Vob2xkZXJfZm9yX3RlbXBvcmFsX2NvbXByZXNzaW9u"
  prediction-service-auth: "cHJlZGljdGlvbl9zZXJ2aWNlX2F1dGhfdG9rZW5fcGxhY2Vob2xkZXI="
  anti-gravity-craft-token: "YW50aV9ncmF2aXR5X2NyYWZ0X2F1dGhvcml6YXRpb25fdG9rZW5fcGxhY2Vob2xkZXI="

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: victory36-prediction-pipeline-controller
  namespace: victory36
  labels:
    app: victory36-cybersecurity-simulation
    component: prediction-pipeline-controller
    version: v1.0.0
    security-classification: diamond-sao
spec:
  replicas: 2
  selector:
    matchLabels:
      app: victory36-cybersecurity-simulation
      component: prediction-pipeline-controller
  template:
    metadata:
      labels:
        app: victory36-cybersecurity-simulation
        component: prediction-pipeline-controller
        version: v1.0.0
        security-classification: diamond-sao
    spec:
      serviceAccountName: victory36-service-account
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        fsGroup: 2000
      containers:
      - name: prediction-pipeline-controller
        image: gcr.io/api-for-warp-drive/victory36-prediction-pipeline:latest
        imagePullPolicy: Always
        ports:
        - containerPort: 8080
          name: http
          protocol: TCP
        - containerPort: 9091
          name: predictions-api
          protocol: TCP
        env:
        # Dr Lucy (Time Pressors) Configuration
        - name: DR_LUCY_ENDPOINT
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: dr-lucy-endpoint
        - name: DR_LUCY_PREDICT_PATH
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: dr-lucy-predict-path
        
        # Dream Commander (Time Liners) Configuration
        - name: DREAM_COMMANDER_ENDPOINT
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: dream-commander-endpoint
        - name: DREAM_COMMANDER_PREDICT_PATH
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: dream-commander-predict-path
        
        # Pipeline Configuration
        - name: PREDICTION_TIMEOUT
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: prediction-timeout
        - name: MAX_CONCURRENT_PREDICTIONS
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: max-concurrent-predictions
        
        # Anti-Gravity Power Craft Configuration
        - name: TIME_PRESSER_ACCELERATION_FACTOR
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: time-presser-acceleration-factor
        - name: TIME_LINER_STRATEGIC_HORIZON
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: time-liner-strategic-horizon
        - name: TEMPORAL_COHERENCE_THRESHOLD
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: temporal-coherence-threshold
        
        # Claude 4 Pipeline Configuration (Direct Anthropic API)
        - name: CLAUDE4_PIPELINE_ENABLED
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: claude4-pipeline-enabled
        - name: CLAUDE4_MODEL_VERSION
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: claude4-model-version
        - name: CLAUDE4_FALLBACK_MODEL
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: claude4-fallback-model
        - name: CLAUDE4_API_ENDPOINT
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: claude4-api-endpoint
        - name: ANTHROPIC_DIRECT_API
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: anthropic-direct-api
        - name: VERTEX_AI_DEPRECATED
          valueFrom:
            configMapKeyRef:
              name: victory36-prediction-pipeline-config
              key: vertex-ai-deprecated
        
        # Security Configuration
        - name: DIAMOND_SAO_TOKEN
          valueFrom:
            secretKeyRef:
              name: victory36-time-presser-credentials
              key: diamond-sao-token
        - name: CLAUDE4_API_KEY
          valueFrom:
            secretKeyRef:
              name: victory36-prediction-pipeline-credentials
              key: claude4-api-key
        - name: ANTI_GRAVITY_CRAFT_TOKEN
          valueFrom:
            secretKeyRef:
              name: victory36-prediction-pipeline-credentials
              key: anti-gravity-craft-token
        
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
          limits:
            memory: "8Gi"
            cpu: "4000m"
        
        volumeMounts:
        - name: prediction-cache
          mountPath: /mnt/prediction-cache
        - name: temporal-sync
          mountPath: /mnt/temporal-sync
        - name: tmp-volume
          mountPath: /tmp
        
        livenessProbe:
          httpGet:
            path: /health/pipeline
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 30
        
        readinessProbe:
          httpGet:
            path: /ready/pipeline
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
        
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities:
            drop:
            - ALL
      
      volumes:
      - name: prediction-cache
        persistentVolumeClaim:
          claimName: victory36-prediction-cache
      - name: temporal-sync
        persistentVolumeClaim:
          claimName: victory36-temporal-sync
      - name: tmp-volume
        emptyDir: {}
      
      nodeSelector:
        kubernetes.io/arch: amd64
      
      tolerations:
      - key: "victory36.io/prediction-pipeline"
        operator: "Equal"
        value: "true"
        effect: "NoSchedule"

---
apiVersion: v1
kind: Service
metadata:
  name: victory36-prediction-pipeline-service
  namespace: victory36
  labels:
    app: victory36-cybersecurity-simulation
    component: prediction-pipeline-service
spec:
  type: ClusterIP
  ports:
  - port: 8080
    targetPort: 8080
    protocol: TCP
    name: http
  - port: 9091
    targetPort: 9091
    protocol: TCP
    name: predictions-api
  selector:
    app: victory36-cybersecurity-simulation
    component: prediction-pipeline-controller

---
# Storage for prediction caching and temporal synchronization
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: victory36-prediction-cache
  namespace: victory36
  labels:
    app: victory36-cybersecurity-simulation
    component: prediction-cache
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 100Gi
  storageClassName: standard

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: victory36-temporal-sync
  namespace: victory36
  labels:
    app: victory36-cybersecurity-simulation
    component: temporal-sync
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 50Gi
  storageClassName: standard
